/*============================================================================
 * @author     : Jae Yong Lee (leejaeyong7@gmail.com)
 * @file       : ObjectHandler.cs
 * @brief      : Event handler for Object menu
 * Copyright (c) Jae Yong Lee / UIUC Fall 2016
 =============================================================================*/
//----------------------------------------------------------------------------//
//                               CLASS IMPORTS                                //
//----------------------------------------------------------------------------//
using UnityEngine;
using System.Collections;
using com.ootii.Messages;
//----------------------------------------------------------------------------//
//                             END CLASS IMPORTS                              //
//----------------------------------------------------------------------------//
//----------------------------------------------------------------------------//
//                             CLASS DEFINITIONS                              //
//----------------------------------------------------------------------------//
public class ObjectHandler : MonoBehaviour {
    //********************************************************************//
    //***************************BEGIN VARIABLES**************************//
    //********************************************************************//
    //====================================================================//
    //                    PUBLIC VARIABLE DEFINITIONS                     //
    //====================================================================//
    public Models models;
	public bool isObjectPlaceMode;
    public GameObject currObj = null;
	//====================================================================//
	//                  END PUBLIC VARIABLE DEFINITIONS                   //
	//====================================================================//
	//====================================================================//
	//                    PRIVATE VARIABLE DEFINITIONS                    //
	//====================================================================//
	//====================================================================//
	//                  END PRIVATE VARIABLE DEFINITIONS                  //
	//====================================================================//
	//********************************************************************//
	//****************************END VARIABLES***************************//
	//********************************************************************//
	//********************************************************************//
	//****************************BEGIN METHODS***************************//
	//********************************************************************//
	//====================================================================//
	//                 MONOBEHAVIOR FUNCTION DEFINITIONS                  //
	//====================================================================//
    void Start()
    {
        MessageDispatcher.AddListener("OBJECT_SELECT_ITEM_CLICKED", delegate (IMessage rMessage)
        {
            isObjectPlaceMode = true;
            currObj = Instantiate((GameObject)rMessage.Data);
        });
    }
    void Update()
    {
        if (Input.GetMouseButtonDown(0))
        {
            if (isObjectPlaceMode)
            {
                if (currObj != null && currObj.active)
                {
                    currObj.transform.parent = models.Objects.transform;
                    currObj = null;
                }
                else if(!currObj.active)
                {
                    Destroy(currObj);
                    currObj = null;
                }
                isObjectPlaceMode = false;
            }
        }
        else if (Input.GetMouseButtonDown(2))
        {
            Destroy(currObj);
            currObj = null;
        }
    }
	//====================================================================//
	//               END MONOBEHAVIOR FUNCTION DEFINITIONS                //
	//====================================================================//
	//====================================================================//
	//                     PUBLIC METHOD DEFINITIONS                      //
	//====================================================================//
	//====================================================================//
	//                   END PUBLIC METHOD DEFINITIONS                    //
	//====================================================================//
	//====================================================================//
	//                     PRIVATE METHOD DEFINITIONS                     //
	//====================================================================//
	//====================================================================//
	//                   END PRIVATE METHOD DEFINITIONS                   //
	//====================================================================//
	//********************************************************************//
	//*****************************END METHODS****************************//
	//********************************************************************//
	//********************************************************************//
	//******************************BEGIN ETC*****************************//
	//********************************************************************//
	//====================================================================//
	//                    HELPER FUNCTION DEFINITIONS                     //
	//====================================================================//
	//====================================================================//
	//                  END HELPER FUNCTION DEFINITIONS                   //
	//====================================================================//
	//********************************************************************//
	//*******************************END ETC******************************//
	//********************************************************************//
}
//----------------------------------------------------------------------------//
//                           END CLASS DEFINITIONS                            //
//----------------------------------------------------------------------------//
